# macOS App Build and DMG Packaging
I found myself to this part of the process manually too many times so I figure "to the automation lab!" with Batman music of the 80s ðŸ˜…## Overview`build_and_package.sh` automates building the `ADFinder` macOS app from an Xcode project and packaging it into a DMG using `gendmg.sh`. It builds, archives, and exports an unsigned app bundle (mimicking Xcodeâ€™s Custom/Direct Distribution export) and generates a versioned DMG (e.g., `ADFinder-1.0_387.dmg`) without opening Xcode.## Features- Builds and archives the Xcode project using `xcodebuild`.- Exports an unsigned app bundle for local or internal use.- Integrates with `gendmg.sh` to create a DMG with a custom layout.- Validates inputs and ensures 1GB minimum disk space.- Supports automation and CI/CD pipelines.## Requirements- macOS with Xcode command-line tools (`xcode-select --install`).- Xcode project (`ADFinder.xcodeproj` or `.xcworkspace`) with a valid scheme.- `gendmg.sh` in `distribution/` directory.- `exportOptions.plist` for unsigned export settings.- Input files: `README.md`, `dmg_assets/dmg-background.png`, `dmg_assets/dmg-icon.icns`.- Homebrew and `create-dmg` (installed by `gendmg.sh`).## Installation1. Save `build_and_package.sh` in the project root.2. Make it executable:   ```bash   chmod +x build_and_package.sh   ```3. Ensure `gendmg.sh` is in `distribution/` and executable.4. Create `exportOptions.plist` for unsigned export:   ```xml   <?xml version="1.0" encoding="UTF-8"?>   <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">   <plist version="1.0">   <dict>       <key>method</key>       <string>development</string>       <key>signingStyle</key>       <string>manual</string>       <key>compileBitcode</key>       <false/>       <key>stripSwiftSymbols</key>       <true/>   </dict>   </plist>   ```## UsageRun from the project root:```bash./build_and_package.sh [--project <project_path>] [--scheme <scheme>] [--configuration <config>]```### Example```bash./build_and_package.sh --project ADFinder.xcodeproj --scheme ADFinder --configuration Release```This builds an unsigned `ADFinder.app` and creates `releases/ADFinder-1.0_387.dmg`.## Notes- The script exports an unsigned app, matching Xcodeâ€™s Custom/Direct Distribution with no signing.- Ensure `Info.plist` has `CFBundleShortVersionString` and `CFBundleVersion` for DMG naming.- For public distribution, add signing and notarization (contact maintainer for details).- See `distribution/gendmg.md` for `gendmg.sh` details.## LicenseProvided as-is, free to use and modify.