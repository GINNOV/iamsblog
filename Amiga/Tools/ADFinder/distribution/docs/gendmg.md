# Distribute it
I found myself to this part of the process manually too many times so I figure "to the automation lab!" with Batman music of the 80s ðŸ˜…

# gendmg.sh - macOS DMG Creation Script## Overview`gendmg.sh` creates a macOS Disk Image (DMG) for distributing an unsigned macOS application (e.g., `ADFinder.app`). It packages the app and a README file into a DMG with a custom layout, including a background image, volume icon, and versioned filename (e.g., `ADFinder-1.0_387.dmg`) based on the appâ€™s `Info.plist`.## Features- Creates a DMG with custom window size, icon positions, and background.- Includes the app and README, with an Applications folder link.- Names the DMG using the appâ€™s version (`CFBundleShortVersionString`) and build number (`CFBundleVersion`).- Checks for 1GB minimum disk space in the output directory.- Prompts before overwriting an existing DMG.- Cleans up temporary files, even on interruption.- Provides debug output for troubleshooting.## Requirements- macOS with command-line tools.- Homebrew for installing `create-dmg` (auto-installed if missing).- Unsigned app bundle (e.g., `ADFinder.app`) with `Info.plist` containing `CFBundleShortVersionString` and `CFBundleVersion`.- README file (e.g., `README.md`).- Background image (e.g., `dmg_assets/dmg-background.png`).- Volume icon (e.g., `dmg_assets/dmg-icon.icns`).- 1GB free disk space in the output directory.## Installation1. Save as `gendmg.sh` in `distribution/`.2. Make executable:   ```bash   chmod +x distribution/gendmg.sh   ```3. Ensure Homebrew is installed:   ```bash   /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"   ```4. Place background image and volume icon in `dmg_assets/`.## UsageRun from the command line:```bash./gendmg.sh --readme <readme_path> [--app <app_path>] [--dmg <dmg_path>] [--background <background_path>] [--volicon <volicon_path>]```### Arguments- **Required**:  - `--readme <readme_path>`: Path to README (e.g., `README.md`).- **Optional**:  - `--app <app_path>`: App bundle path (default: `~/Downloads/ADFinder.app`).  - `--dmg <dmg_path>`: Output DMG path (default: `~/Downloads/ADFinder.dmg`).  - `--background <background_path>`: Background PNG (default: `./dmg_assets/dmg-background.png`).  - `--volicon <volicon_path>`: Volume icon ICNS (default: `./dmg_assets/dmg-icon.icns`).### Example```bash./gendmg.sh --readme README.md --app ~/Downloads/ADFinder/ADFinder.app --dmg ../../releases/ADFinder.dmg --background dmg_assets/dmg-background.png --volicon dmg_assets/dmg-icon.icns```Creates `../../releases/ADFinder-1.0_387.dmg` (assuming `Info.plist` has `CFBundleShortVersionString: 1.0`, `CFBundleVersion: 387`).## How It Works1. Parses arguments, requiring `--readme`.2. Extracts app version and build number from `Info.plist`.3. Names the DMG `<base>-<version>_<build>.dmg` (e.g., `ADFinder-1.0_387.dmg`).4. Validates inputs, disk space, and prompts for overwrite.5. Installs `create-dmg` if needed.6. Copies the unsigned app and README to a temporary directory.7. Creates the DMG with custom layout using `create-dmg`.8. Cleans up temporary files.## Notes- Assumes an unsigned app for local/internal use, matching Xcodeâ€™s Custom/Direct Distribution export.- For public distribution, add signing and notarization (contact maintainer for details).- The `--no-internet-enable` flag avoids quarantine attributes for local use; downloaded DMGs may still be quarantined by macOS.- Verify `Info.plist` has required keys:  ```bash  defaults read <app_path>/Contents/Info CFBundleShortVersionString  defaults read <app_path>/Contents/Info CFBundleVersion  ```## LicenseProvided as-is, free to use and modify.